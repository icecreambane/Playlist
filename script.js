// Playlist dictionary


const playlist = {
    "Booraye - Ian Clarke": ["booraye_ian_clarke","rgb(120 86 65)"],
    "After the Fall - Two Steps From Hell": ["After_the_Fall_Two_Steps_From_Hell","rgb(225 113 49)"],
    "Archangel - Two Steps From Hell": ["Archangel_Two_Steps_From_Hell","rgb(67 53 48)"],
    "Birth of a Hero - Two Steps From Hell": ["Birth_of_a_Hero_Two_Steps_From_Hell","rgb(102 96 75)"],
    "Blackheart - Two Steps From Hell": ["Blackheart_Two_Steps_From_Hell","rgb(115 132 134)"],
    "Black Blade - Two Steps From Hell": ["black_blade","rgb(26 94 126)"],
    "Breathe - Two Steps From Hell":["breathe","rgb(128 180 223)"],
    "Colors of Love - Two Steps From Hell": ["Colors_of_Love_Two_Steps_From_Hell","rgb(206 142 105)"],
    "Compass - Two Steps From Hell": ["Compass_Two_Steps_From_Hell","rgb(201 132 87)"],
    "El Dorado - Two Steps From Hell": ["El_Dorado_Two_Steps_From_Hell","rgb(192 149 106)"],
    "Empire of Angels - Two Steps From Hell": ["Empire_of_Angels_Two_Steps_From_Hell","rgb(97 151 162)"],
    "Flight of the Silverbird - Two Steps From Hell": ["Flight_of_the_Silverbird_Two_Steps_From_Hell","rgb(122 137 143)"],
    "For the Win - Two Steps From Hell": ["For_the_Win_Two_Steps_From_Hell","rgb(188 210 210)"],
    "Freedom Fighters - Two Steps From Hell": ["Freedom_Fighters_Two_Steps_From_Hell","rgb(224 219 208)"],
    "Immortal - Two Steps From Hell": ["Immortal_Two_Steps_From_Hell","rgb(235 201 180)"],
    "Impossible - Two Steps From Hell": ["Impossible_Two_Steps_From_Hell","rgb(47 70 68)"],
    "Invincible - Two Steps From Hell": ["invincible_tsfh","rgb(52 183 244)"],
    "Love & Loss - Two Steps From Hell":["loveloss_tsfh","rgb(100 159 189)"],
    "Magika - Two Steps From Hell": ["magika","rgb(0 184 226)"],
    "Never Back Down - Two Steps From Hell": ["Never_Back_Down_Two_Steps_From_Hell","rgb(158 129 122)"],
    "Pegasus - Two Steps From Hell": ["Pegasus_Two_Steps_From_Hell","rgb(53 105 111)"],
    "Protectors of the Earth - Two Steps From Hell": ["Protectors_of_the_Earth_Two_Steps_From_Hell","rgb(205 158 118)"],
    "Secret Melody - Two Steps From Hell": ["secret_melody_tsfh","rgb(165 140 124)"],
    "Stallion - Two Steps From Hell": ["Stallion_Two_Steps_From_Hell","rgb(214 167 142)"],
    "Starfall - Two Steps From Hell": ["Starfall_Two_Steps_From_Hell","rgb(221 176 195)"],
    "Star Sky - Two Steps From Hell": ["Star_Sky_Two_Steps_From_Hell","rgb(113 155 158)"], // need to do this next
    "Strength of a Thousand Men - Two Steps From Hell": ["Strength_of_a_Thousand_Men_Two_Steps_From_Hell","rgb(194 171 154)"],
    "To Glory - Two Steps From Hell": ["To_Glory_Two_Steps_From_Hell","rgb(198 166 152)"],
    "Unleashed - Two Steps From Hell": ["unleashed_tsfh","rgb(131 190 213)"],
    "Victory - Two Steps From Hell": ["Victory_Two_Steps_From_Hell","rgb(170 135 104)"],
    "Winterspell - Two Steps From Hell": ["winterspell_tsfh","rgb(41 173 220)"],
    "Victory X Heart of Courage - Remix": ["Victory_X_Heart_of_Courage","rgb(129 128 179)"],
    "Children of the Sun - Thomas Bergersen": ["Children_of_the_Sun","rgb(224 153 50)"],
    "Final Frontier - Thomas Bergersen": ["Final_Frontier_Thomas_Bergersen","rgb(194 102 97)"],
    "Rada - Thomas Bergersen":["Rada","rgb(228 178 117)"],
    "Rohan Theme - Lord of the Rings (LOTR)": ["Rohan_Theme_LOTR","rgb(145 157 158)"],
    "Rohan Rohirrim Soundtrack - LOTR": ["Rohan_Rohirrim_Soundtrack_LOTR","rgb(121 126 63)"],
    "Unravel Remix - Tokyo Ghoul (Samuel Kim)": ["Unravel_Tokyo_Ghoul","rgb(227 196 237)"],
    "Kai's Theme - Kung Fu Panda (Samuel Kim)": ["Kai_Theme_Kung_Fu_Panda","rgb(2 232 154)"],
    "Rengoku Theme - Demon Slayer (Samuel Kim)": ["Rengoku_Theme_Demon_Slayer","rgb(225 150 97)"],
    "Inosuke Theme V2 - Demon Slayer (Samuel Kim)": ["Inosuke_Theme_V2_Demon_Slayer","rgb(174 139 173)"],
    "Gurenge (Demon Slayer) - Samuel Kim": ["Gurenge_Demon_Slayer","rgb(35 203 237)"],
    "Akaza vs Rengoku Theme - Samuel Kim": ["Akaza_theme","rgb(238 170 118)"],
    "Tokyo Revengers Main Theme - Samuel Kim": ["Tokyo_Revengers_Main_Theme","rgb(248 219 214)"],
    "The Battle for Me Myself - Tokyo Revengers": ["The_Battle_for_Me_Myself_Tokyo_Revengers","rgb(240 220 214)"],
    "Our Dream - Tokyo Revengers": ["Our_Dream_Tokyo_Revengers","rgb(240 220 214)"],
    "Call of Silence (Lofi) - Attack on Titan": ["Call_of_Silence_Attack_on_Titan","rgb(119 134 124)"],
    "My Soul - July": ["My_Soul_July","rgb(210 182 164)"],
    "Somewhere - July": ["Somewhere_July","rgb(181 140 128)"],
    "逆时针向 - Asphyxia": ["逆时针向_Asphyxia","rgb(135 224 234)"],
    "KOMOREBI - 鲸落版": ["KOMOREBI鲸落版","rgb(78 216 247)"],
    "Last Reunion - Peter Roe": ["last_reunion","rgb(3 137 149)"],
    "Sword Art Online - Theme": ["Sword_Art_Online","rgb(47 148 168)"],
    "Interstellar - Theme": ["interstellar_theme","rgb(255 169 167)"],
    "Bloody Mary - Instrumental": ["Bloody_Mary_Instrumental","rgb(81 175 197)"],
    "Fake Love Orchestral - BTS": ["Fake_Love_Orchestral_BTS","rgb(194 194 188)"],
    "浮光 - Music": ["浮光_Music","rgb(248 143 0)"],
    "天耀中华 (伴奏) - 徐千雅": ["天耀中华_伴奏_徐千雅","rgb(179 104 83)"],
    "黑色裂變 - 大秦帝國": ["黑色裂變_大秦帝國","rgb(88 163 83)"],
    "Grand Ceremony of Qin - Instrumental": ["Grand_Ceremony_Qin","rgb(173 33 63)"],
    "秦汉英雄传 - 片尾曲": ["Qin_Han","rgb(192 164 129)"],
    "琅琊榜 - 主题音乐": ["琅琊榜_主题音乐","rgb(102 204 214)"],
    "中國軍魂 - Music": ["中國軍魂","rgb(39 168 193)"],
    "錦繡山河 - Music":["錦繡山河","rgb(251 92 33)"],
    "White Dew - 羽腫": ["White_dew","rgb(158 181 122)"],
    "告白の夜 - Music": ["the_reason_why","rgb(27 167 244)"],
    "最后的审判 - 琅琊榜": ["最后的审判_琅琊榜","rgb(243 230 252)"],
    "高進 - 聽著情歌流眼淚": ["聽著情歌流眼淚_高進","rgb(155 80 52)"],
    "百鸟归巢 - 谭维维": ["百鸟归巢_谭维维","rgb(138 225 174)"],
    "天耀中华 - 姚贝娜": ["天耀中华_姚贝娜","rgb(230 124 96)"],
    "有種 - 流浪地球": ["有種_流浪地球","rgb(69 172 240)"],
    "人是_ - 流浪地球2": ["人是_流浪地球2","rgb(3 191 213)"],
    "璀璨冒险人 - 周深": ["璀璨冒险人","rgb(71 129 137)"],
    "为你而来 - 袁娅维": ["为你而来","rgb(212 161 221)"],
    "歷史的天空 - 三國演義": ["歷史的天空_三國演義","rgb(17 155 174)"],
    "主題曲 - 大俠霍元甲": ["主題曲_大俠霍元甲","rgb(127 111 146)"],
    "红日 - 李克勤": ["红日_李克勤","rgb(110 203 241)"],
    "刀劍如夢 - 周華健": ["刀劍如夢_周華健","rgb(157 188 235)"],
    "神话情话 - 周华健, 齐豫 ": ["神话情话_周华健_齐豫 ","rgb(146 210 250)"],
    "诉衷情 - 伪装者": ["诉衷情_伪装者","rgb(151 114 80)"],
    "等待 - 韩磊": ["等待_韩磊","rgb(237 180 120)"],
    "海闊天空 - Beyond": ["海闊天空_Beyond","rgb(237 238 232)"],
    "一生有意义 - 射雕英雄传之东邪西毒": ["一生有意义_射雕英雄传之东邪西毒","rgb(176 133 66)"],
    "鐵血丹心 - 射鵰英雄傳": ["鐵血丹心_射鵰英雄傳","rgb(122 128 105)"],
    "留下我美夢 - TVB 甄妮" : ["留下我美夢_甄妮","rgb(203 165 152)"],
    "一生所愛 - 大话西游": ["一生所愛_大话西游","rgb(236 194 135)"],
    "天命最高 - 古天乐 (寻秦记主题曲)": ["天命最高_古天乐","rgb(177 194 150)"],
    "天下 - 大秦賦": ["天下_大秦賦","rgb(241 187 120)"],
    "珍惜 - 李宇春": ["珍惜_李宇春","rgb(155 122 98)"],
    "忘川 - 小曲兒 (曲終人未散)": ["忘川_小曲兒","rgb(251 220 214)"],
    "终于等到你 - 张靓颖": ["终于等到你_张靓颖","rgb(200 226 205)"],
    "绝唱 - 生死谍恋": ["绝唱_生死谍恋","rgb(39 70 109)"],
    "假如爱有天意 - 李健": ["假如爱有天意_李健","rgb(247 202 225)"],
    "楊花李樹 - 孫楠": ["楊花李樹_孫楠","rgb(179 222 235)"],
    "美麗的神話 - 胡歌": ["美麗的神話_胡歌","rgb(167 188 237)"],
    "我的血液 - 杨门虎将": ["我的血液_杨门虎将","rgb(169 156 115)"],
    "玄鸟 - Till the End of the Moon OST": ["玄鸟_Till_the_End_of_the Moon_OST","rgb(140 145 131)"],
    "我不存在的世界 - 潘韵淇": ["我不存在的世界","rgb(175 134 134)"],
    "我的心下起了雪 - 王忻辰": ["我的心下起了雪_王忻辰","rgb(134 121 184)"],
    "櫻花樹下的約定 - 旺仔小喬": ["櫻花樹下的約定_旺仔小喬","rgb(171 145 40)"],
    "天下 - 張杰": ["天下_張杰","rgb(154 127 110)"],
    "起風了 - 買辣椒也用券": ["起風了_買辣椒也用券","rgb(241 164 202)"],
    "笼 - 张碧晨": ["笼_张碧晨","rgb(204 206 136)"],
    "獨角戲 - 許茹芸": ["許茹芸_獨角戲","rgb(138 209 227)"],
    "归途有风 - 王菲": ["归途有风_王菲","rgb(108 217 254)"],
    "飛鳥和蟬 - 任然": ["飛鳥和蟬_任然","rgb(148 200 197)"],
    "葬仙 - 葉里 & 苑舍": ["葬仙_葉里_苑舍","rgb(94 223 254)"],
    "最美的瞬间 - 小阿七": ["最美的瞬间","rgb(244 163 216)"],
    "旧梦一场 - 阿悠悠": ["旧梦一场_阿悠悠","rgb(212 91 112)"],
    "你能不能不要离开我 - 莫叫语": ["你能不能不要离开我_莫叫语","rgb(202 220 235)"],
    "桃花诺 - 邓紫棋": ["桃花诺_邓紫棋","rgb(148 78 169)"],
    "明月天涯 - 五音Jw": ["明月天涯_五音Jw","rgb(187 196 232)"],
    "阴霾 - 高旭": ["阴霾_高旭","rgb(131 169 168)"],
    "美人魚 - 林俊杰": ["美人魚_林俊杰","rgb(123 167 188)"],
    "雲與海 - 阿YueYue": ["雲與海_阿YueYue","rgb(151 196 226)"],
    "夏夜灯塔 - 沈以诚": ["夏夜灯塔_沈以诚","rgb(160 156 221)"],
    "Heaven - Ailee": ["heaven_ailee","rgb(248 139 193)"],
    "I will show you - Ailee": ["I_will_show_you","rgb(109 218 222)"],
    "Fated to love you - Ailee": ["Fated_to_love_you","rgb(132 215 250)"],
    "Orbit - HWASA": ["Orbit_HWASA","rgb(172 160 122)"],
    "monogram - Lucid Dream": ["monogram_Lucid_Dream","rgb(162 212 183)"],
    "Once Again - Mad Clown & Kim Nayoung": ["Once_Again_Mad_Clown","rgb(79 170 168)"],
    "Done For Me - Punch Hotel Del Luna OST": ["Done_For_Me","rgb(196 173 221)"],
    "Fate - Lee Sun Hee": ["Fate","rgb(115 206 231)"],
    "SBS Temptation of Wife - OST": ["Temptation_of_Wife","rgb(108 192 212)"],
    "Scars leave beautiful trace - OST": ["Scars_leave_beautiful_trace","rgb(122 197 231)"],
    "Suddenly - City Hunter": ["Suddenly_City_Hunter","rgb(197 220 85)"],
    "In The Dark": ["In_The_Dark","rgb(149 150 171)"],
    "Sigriswil - OST": ["Sigriswil","rgb(55 218 231)"],
    "See The Light - Lim Hyunsik": ["See_The_Light","rgb(109 129 195)"],
    "Wa - Lee Jung-hyun": ["Wa","rgb(186 150 165)"],
    "Kill me Heal me - OST": ["Kill_me_heal_me_OST","rgb(142 182 207)"],
    "This Love - DAVICHI": ["This_Love_DAVICHI","rgb(121 148 155)"],
    "Everytime - CHEN & Punch": ["Everytime_CHEN_Punch","rgb(232 228 224)"],
    "Love Attack - Rescene": ["Love_Attack_Rescene","rgb(176 202 211)"],
    "Fall In Love Again - TWICE": ["Fall_In_Love_Again_TWICE","rgb(228 146 190)"],
    "Mago - GFRIEND": ["Mago_GFRIEND","rgb(151 151 151)"],
    "Mise-en-Scène - IZ*ONE": ["Mise_en_Scène_IZ*ONE","rgb(200 240 252)"],
    "O Sole Mio - IZ*ONE": ["O_Sole_Mio_IZ*ONE","rgb(185 253 252)"],
    "Island - IZ*ONE": ["Island_IZ*ONE","rgb(240 210 225)"],
    "해바라기 Hey. Bae. Like It. - IZ*ONE": ["Hey_Bae_Like_It_IZ*ONE","rgb(226 198 246)"],
    "First Love (첫사랑) - After School": ["First_Love_After_School","rgb(139 175 196)"],
    "Siren - Sunmi": ["Siren_Sunmi","rgb(221 165 137)"],
    "Dumhdurum - Apink": ["Dumhdurum_Apink","rgb(239 214 238)"],
    "Girls - NATURE": ["Girls_NATURE","rgb(163 181 206)"],
    "Diamond - TRI.BE": ["Diamond_TRIBE","rgb(231 175 85)"],
    "Start - Dreamcatcher": ["Start","rgb(146 197 230)"],
    "Rollercoaster - Chungha": ["Rollercoaster_Chungha","rgb(134 128 125)"],
    "Bon Voyage - YooA": ["Bon_Voyage_YooA","rgb(237 199 167)"],
    "Virtual Angel - ARTMS": ["Virtual_Angel_ARTMS","rgb(18 206 234)"],
    "Girls Never Die - tripleS": ["Girls_Never_Die_tripleS","rgb(212 181 175)"],
    "Paradise - infinite": ["paradise_infinite","rgb(220 145 213)"],
    "Rooftop - N.Flying": ["Rooftop_NFlying","rgb(236 245 119)"],
    "beautiful - BEAST": ["beautiful_BEAST","rgb(137 220 251)"],
    "LUNA - ONEUS": ["LUNA_ONEUS","rgb(86 157 255)"],
    "Valkyrie (발키리) - ONEUS": ["Valkyrie_ONEUS","rgb(0 149 186)"],
    "To Be Or Not To Be - ONEUS": ["To_Be_Or_Not_To_Be_ONEUS","rgb(242 225 178)"],
    "A Song Written Easily - ONEUS": ["A_Song_Written_Easily_ONEUS","rgb(57 193 207)"],
    "Deja Vu - TOMORROW X TOGETHER":["Deja_Vu_TOMORROW_X_TOGETHER","rgb(204 181 141)"],
    "LO$ER=LO♡ER - TOMORROW X TOGETHER": ["Loser_Lover_TOMORROW_X_TOGETHER","rgb(146 156 201)"],
    "Chasing That Feeling - TOMORROW X TOGETHER": ["Chasing_That_Feeling_TOMORROW_X_TOGETHER","rgb(106 128 131)"],
    "FLASH - X1": ["FLASH_X1","rgb(136 102 134)"],
    "Fatal Trouble - ENHYPEN": ["Fatal_Trouble_ENHYPEN","rgb(152 221 244)"],
    "Answer - ATEEZ": ["Answer_ATEEZ","rgb(145 127 192)"],
    "Inception - ATEEZ": ["Inception_ATEEZ","rgb(187 159 204)"],
    "Say My Name - ATEEZ": ["Say_My_Name_ATEEZ","rgb(170 219 233)"],
    "This Is War - MBLAQ": ["This_Is_War_MBLAQ","rgb(116 216 236)"],
    "Trap - Henry": ["Trap_Henry","rgb(211 165 195)"],
    "Trap - Henry (CHN)": ["Trap_Henry_CHN","rgb(255 180 178)"],
    "BLUE - BIGBANG": ["BLUE_Bigbang","rgb(109 179 255)"],
    "Fiction - BEAST": ["Fiction_BEAST","rgb(90 154 198)"],
    "Fiction - BEAST (Cover)": ["Fiction_Female","rgb(139 222 221)"],
    "Hotaru - Fujita Maiko": ["Hotaru_Fujita_Maiko","rgb(225 218 231)"],
    "Blue Bird - Naruto": ["Blue_Bird_Naruto","rgb(96 200 235)"],
    "shigure - Music": ["shigure","rgb(170 161 215)"],
    "悪魔の子 (Rock Remix) - Attack on Titan": ["悪魔の子_Attack_on_Titan","rgb(167 145 146)"],
    "夢と葉桜 - 青木月光": ["夢と葉桜","rgb(228 194 220)"],
    "さくらひらり - Tomo": ["さくらひらり_Tomo","rgb(243 215 166)"],
    "Spirits - KOKIA": ["Spirits_KOKIA","rgb(241 211 108)"],
    "When the flowers fall - 桜の花が舞い落ちるとき": ["When_the_flowers_fall","rgb(191 162 195)"],
    "The Final Countdown Remix - Europe": ["The_Final_Countdown_Remix_Europe","rgb(192 154 118)"],
    "Bring Me to Life - Evanescence": ["Bring_Me_to_Life_Evanescence","rgb(130 95 170)"],
    "I'll Do It - Heidi Montag": ["Ill_Do_It_Heidi_Montag","rgb(90 104 114)"],
    "Håll Om Mig - Nanne Grönvall":  ["Hall_Om_Mig_Nanne_Gronvall","rgb(216 184 149)"],
    "I'm Good (Blue) - Bebe Rexha & David Guetta": ["Im_Good_Bebe_Rexha_David_Guetta","rgb(98 139 226)"],
    "DYNASTY x FICTION - Remix": ["DYNASTY_x_FICTION_Remix","rgb(232 178 123)"],
    "Mimimi - Dramma": ["Mimimi_Dramma","rgb(182 152 132)"],
    "Beautiful Mess - Kristian Kostov": ["Beautiful_Mess","rgb(140 220 255)"],
    "Beautiful Mess (China) - Kristian Kostov": ["Beautiful_Mess_China","rgb(63 134 189)"],
    "DaDaDa (Да да да) - Jarico": ["DaDaDa_Jarico","rgb(120 177 220)"],
    "Take Me To Church - Hozier (Female Version)": ["Take_Me_To_Church_Hozier_Female","rgb(249 221 174)"],
    "Around The World (La La La) - ATC": ["Around_The_World_LaLaLa_ATC","rgb(240 173 161)"],
    "Nevada - Vicetone": ["Nevada_Vicetone","rgb(125 189 241)"],
    "Why Do I": ["Why_do_i","rgb(182 227 255)"],
    "underwater (sped up) - Nikki Flores": ["underwater","rgb(98 212 244)"],
    "Monody - TheFatRat": ["Monody_TheFatRat","rgb(167 163 165)"],
    "Monody - Epic Version": ["Monody_Epic_Version","rgb(147 195 211)"],
    "We all lie - Sky 캐슬 OST Part 4": ["We_all_lie","rgb(232 182 153)"],
    "Pray - Klang; Angel's Last Mission: Love OST": ["Pray_Klang","rgb(125 203 255)"],
    "Numb -  Linkin Park (Remix)": ["Numb_Remix","rgb(132 146 148)"],
    "Sold out - Hawk Nelson": ["Sold_out","rgb(86 7 5)"],
    "Take Me Hand - Daishi Dance": ["Take_Me_Hand_Daishi_Dance","rgb(232 160 147)"],
    "印第安曲 - Music": ["印第安曲","rgb(92 203 254)"],
    "迴夢遊仙 - Music": ["迴夢遊仙","rgb(179 191 178)"],
    "That Girl x Talking To The Moon - Remix": ["That_Girl_x_Talking_To_The_Moon","rgb(191 196 217)"],
};
console.log(Object.keys(playlist).length); // length of song playlist 
console.log("BOORAYE: ", darkenRGB("rgb(249 204 153)",60));
let currentSongIndex = 0;  // Keeps track of the song position in the playlist

// Get references to the audio player and the song select dropdown
const audioPlayer = document.getElementById('audioPlayer');
const audioSource = document.getElementById('audioSource');
const albumArt = document.getElementById('albumArt');
const songSelect = document.getElementById('songSelect');
const playPauseButton = document.getElementById('playPauseButton');
const repeatIcon = document.getElementById('repeatButtonIcon');

// Function to populate the playlist
function populatePlaylist() {
    const container = document.getElementById('container-playlist');
    const dropdown = document.getElementById('songSelect');
    
    container.innerHTML = '';  // Clear previous songs
    dropdown.innerHTML = '';   // Clear dropdown options

    // Loop through the playlist object to create song items
    for (const title in playlist) {
        if (playlist.hasOwnProperty(title)) {
            // Create div for scrollable playlist
            const songDiv = document.createElement('div');
            songDiv.classList.add('song-item');
            songDiv.textContent = title;

            // Add click event to play the song
            songDiv.addEventListener('click', function() {
                currentSongIndex = Object.keys(playlist).indexOf(title);  // Update the index based on clicked song
                playSong(title);  // Play the selected song
            });

            container.appendChild(songDiv);

            // Create an option for the dropdown
            const option = document.createElement('option');
            option.textContent = title;
            option.value = title;
            dropdown.appendChild(option);
        }
    }
}

function darkenRGB(rgbString, percentage) {

    rgbString = rgbString.replace(/\s+/g, ',');

    // Extract the RGB values from the string using regex
    const regex = /^rgb\((\d+),(\d+),(\d+)\)$/;
    const match = rgbString.match(regex);
    
    if (match) {
        let r = parseInt(match[1]);
        let g = parseInt(match[2]);
        let b = parseInt(match[3]);
        
        const darken = 1 - (percentage / 100);

        r = Math.max(0, r * darken);
        g = Math.max(0, g * darken);
        b = Math.max(0, b * darken);
        return `rgb(${Math.round(r)}, ${Math.round(g)}, ${Math.round(b)})`;
    } 
}

function lightenRGB(rgbString, percentage) {
    console.log(rgbString);
    rgbString = rgbString.replace(/\s+/g, ',');
    console.log(rgbString);
    
    // Extract the RGB values from the string using regex
    const regex = /^rgb\((\d+),(\d+),(\d+)\)$/;
    const match = rgbString.match(regex);
    
    if (match) {
        let r = parseInt(match[1]);
        let g = parseInt(match[2]);
        let b = parseInt(match[3]);
        
        // Calculate the amount to lighten the color
        const lighten = percentage / 100;

        // Ensure values do not exceed 255
        r = Math.min(255, r + (255 - r) * lighten);
        g = Math.min(255, g + (255 - g) * lighten);
        b = Math.min(255, b + (255 - b) * lighten);
        
        return `rgb(${Math.round(r)}, ${Math.round(g)}, ${Math.round(b)})`;
    } else {
        throw new Error("Invalid RGB string format");
    }
}


const keys = Object.keys(playlist);
const values = Object.values(playlist);


function displaySongInfo(filename) {
    const songContainer = document.getElementById("song-info"); // Ensure you have an element with id="song-info"

    // Find the key in the playlist where the first element matches the filename
    for (const title in playlist) {
        if (playlist[title][0] === filename) {
            // Split the key into song name and artist
            const [songName, songArtist] = title.split(" - ");
            console.log("HAIDFHA");

            document.getElementById('selected-song').innerText = `${songName}`;
            document.getElementById('selected-song-artist').innerText=  `${songArtist}`;
            break;
        }
    }
}



function toRGBA(rgbColor, opacity) {

    return rgbColor.replace('rgb', 'rgba').replace(')', `, ${opacity})`);
}

// Function to play the song
function playSong(title) {
    console.log(title);
    const filename = playlist[title][0];
    
    // Update the audio source and album art
    audioSource.src = `music/${filename}.mp3`; 
    albumArt.src = `albumArt/${filename}.png`;
    displaySongInfo(filename);


    audioPlayer.load();  // Load the new song
    audioPlayer.play();  // Play the new song

    // Optionally update any other UI elements if needed
    console.log(`Playing: ${title} (Song Index: ${currentSongIndex})`);

    // Remove "<--" and bold styling from any previously highlighted song in the playlist
    const playlistItems = document.querySelectorAll('.song-item');
    playlistItems.forEach((item) => {
        item.classList.remove('playing'); // Remove bold styling class
        item.textContent = item.textContent.replace(" ←", ""); // Remove previous indicator
    });

    // Add "<--" and bold styling to the currently playing song in the playlist
    const currentItem = playlistItems[currentSongIndex];
    
    console.log(currentItem.textContent);
    //document.getElementById('selected-song').innerText = currentItem.textContent;
    currentItem.textContent += " ←";
    currentItem.classList.add('playing'); 

    songSelect.value = title;
    updatePlayPauseButton();  // Update the play/pause button state


    const songTitles = Object.keys(playlist);
    const currentSongTitle = songTitles[currentSongIndex];

    console.log(currentSongTitle, " is at ", currentSongIndex);
    const artContainer = document.querySelector('.container');
    artContainer.style.background = `linear-gradient(to bottom, rgba(${lightenRGB(playlist[currentSongTitle][1], 20).match(/\d+/g).join(', ')}, 0.6), rgba(${playlist[currentSongTitle][1].match(/\d+/g).join(', ')}, 0.6))`;

    const img = document.querySelector('.image');
    img.style.boxShadow = `-5px 5px 20px ${darkenRGB(playlist[currentSongTitle][1],30)}`;
    img.style.borderColor=playlist[currentSongTitle][1];
    img.style.border = '10px solid ${darkenRGB(playlist[currentSongTitle][1])';


    const randSongButton = document.getElementById('randomSongButton');
    randSongButton.style.boxShadow = `-5px 5px 5px ${darkenRGB(playlist[currentSongTitle][1],50)}, 
    2px -2px 1px ${lightenRGB(playlist[currentSongTitle][1],10)},
    3px -2px 5px ${darkenRGB(playlist[currentSongTitle][1],10)} inset`;
    randSongButton.style.backgroundColor = lightenRGB(playlist[currentSongTitle][1],20);
    randSongButton.style.color = darkenRGB(playlist[currentSongTitle][1],60);

    const playStopButton = document.getElementById('playPauseButton');

    playStopButton.style.color = darkenRGB(playlist[currentSongTitle][1],60);
    /* playStopButton.style.boxShadow = `-5px 5px 5px ${darkenRGB(playlist[currentSongTitle][1],50)}, 
    2px -2px 1px ${lightenRGB(playlist[currentSongTitle][1],10)},
    3px -2px 5px ${darkenRGB(playlist[currentSongTitle][1],10)} inset`; */
    playStopButton.style.boxShadow= ` 
    3px 3px 5px ${darkenRGB(playlist[currentSongTitle][1],50)} inset,
    -3px 1px 6px ${darkenRGB(playlist[currentSongTitle][1],40)} inset,
    -3px -1px 6px ${darkenRGB(playlist[currentSongTitle][1],40)} inset`;
    playStopButton.style.backgroundColor = lightenRGB(playlist[currentSongTitle][1],10);


    const repeatButton = document.getElementById('repeatButtonIcon');
    repeatButton.style.boxShadow = `-5px 5px 5px ${darkenRGB(playlist[currentSongTitle][1],50)}, 
    2px -2px 1px ${lightenRGB(playlist[currentSongTitle][1],10)},
    3px -2px 5px ${darkenRGB(playlist[currentSongTitle][1],30)} inset`;
    repeatButton.style.backgroundColor = lightenRGB(playlist[currentSongTitle][1],20);
    repeatButton.style.color = darkenRGB(playlist[currentSongTitle][1],40);

    artContainer.style.boxShadow = `-5px 5px 20px ${darkenRGB(playlist[currentSongTitle][1],90)}`;

    const svgProgress = document.getElementById('svgProgress');
    svgProgress.style.stroke = `${lightenRGB(playlist[currentSongTitle][1],70)}`;

    const svgTrack = document.getElementById('svgTrack');
    svgTrack.style.stroke = `${lightenRGB(playlist[currentSongTitle][1],40)}`;

    /* document.body.style.backgroundColor = `${darkenRGB(playlist[currentSongTitle][1],30)}`; */
    document.body.style.background = `radial-gradient(circle at 27% 25%, ${darkenRGB(playlist[currentSongTitle][1], 50)} 40%, ${darkenRGB(playlist[currentSongTitle][1], 30)} 30%, ${darkenRGB(playlist[currentSongTitle][1], 80)} 30%, ${darkenRGB(playlist[currentSongTitle][1], 30)} 80%) repeat-x`;
    const selectedSongArtist = document.getElementById('selected-song-artist');
    selectedSongArtist.style.color = `${lightenRGB(playlist[currentSongTitle][1],80)}`;

    const selectedSong = document.getElementById('selected-song');
    selectedSong.style.color = `${lightenRGB(playlist[currentSongTitle][1],80)}`;
    

    const containerPlaylist = document.getElementById('container-playlist');
    containerPlaylist.style.boxShadow = `-5px 5px 20px ${darkenRGB(playlist[currentSongTitle][1],90)}`;
    containerPlaylist.style.background = `linear-gradient(to bottom, rgba(${lightenRGB(playlist[currentSongTitle][1], 20).match(/\d+/g).join(', ')}, 0.6), rgba(${playlist[currentSongTitle][1].match(/\d+/g).join(', ')}, 0.6))`;


    containerPlaylist.style.borderImage = `linear-gradient(to bottom, ${lightenRGB(playlist[currentSongTitle][1], 20)}, ${playlist[currentSongTitle][1]})`;
    
    containerPlaylist.style.backgroundClip = 'border-box'; // Clips the gradient to the border area
    containerPlaylist.style.padding = '12px'; // Ensure there is space for the border
    containerPlaylist.style.border = '1px solid transparent'; // Creates an invisible border for the effect


    const gradientBorder = `linear-gradient(to bottom, ${lightenRGB(playlist[currentSongTitle][1], 20)}, ${playlist[currentSongTitle][1]})`;
    containerPlaylist.style.boxShadow = `0 0 0 10px ${gradientBorder}`;

    

    const songItems = document.querySelectorAll('.song-item');

    songItems.forEach(songItem => {
    
    // Set the initial background color and box shadow
        songItem.style.backgroundColor = darkenRGB(playlist[currentSongTitle][1],30);
        songItem.style.boxShadow = `-5px 5px 20px ${darkenRGB(playlist[currentSongTitle][1],40)} inset`;
        songItem.style.opacity = '0.8';
        songItem.style.transition = 'background-color 0.3s ease, box-shadow 0.3s ease';

    // Add hover effect to change background color
        songItem.addEventListener('mouseover', () => {
            songItem.style.backgroundColor = darkenRGB(playlist[currentSongTitle][1],30);
            songItem.style.fontSize = "16px";
        });

        // Revert background color when mouse leaves the element
        songItem.addEventListener('mouseout', () => {
            songItem.style.backgroundColor = darkenRGB(playlist[currentSongTitle][1],30);
            songItem.style.fontSize = "15px";
            songItem.style.transition="0.3s";
        });
    });


    seekbar.style.boxShadow = `-5px 5px 10px ${darkenRGB(playlist[currentSongTitle][1],40)} inset`;
    seekbar.style.borderColor =  lightenRGB(playlist[currentSongTitle][1],10);
    seekbar.style.background = `linear-gradient(to right, white 0%, black var(--seek-value), transparent var(--seek-value), black 100%)`;



    const style = document.createElement('style');
    style.innerHTML = `#seekbar::-webkit-slider-thumb {
    box-shadow: 0 0 0px 7px ${darkenRGB(playlist[currentSongTitle][1],40)};}
    #seekbar::-webkit-slider-thumb:hover{box-shadow: 0 0 0px 7px ${darkenRGB(playlist[currentSongTitle][1],30)};
    }
    `;
    document.head.appendChild(style);

    const time = document.getElementById('time');
    time.style.color = `${lightenRGB(playlist[currentSongTitle][1],20)}`;

    const playing = document.querySelector(".playing");
    //playing.style.color =`${lightenRGB(playlist[currentSongTitle][1],60)}`;


}


// Function to update the play/pause button based on the audio state
function updatePlayPauseButton() {
    const songTitles = Object.keys(playlist);
    const currentSongTitle = songTitles[currentSongIndex];

    const img = document.querySelector('.image');
    const playStopButton = document.getElementById('playPauseButton');
    if (audioPlayer.paused) {
        playPauseButton.innerHTML = '<i class="fa fa-play"></i>';
        img.style.animationPlayState = 'paused'; // Pause the animation
        playStopButton.style.boxShadow= `-5px 5px 5px ${darkenRGB(playlist[currentSongTitle][1],50)}, 
    2px -2px 1px ${lightenRGB(playlist[currentSongTitle][1],10)},
    3px 2px 5px ${darkenRGB(playlist[currentSongTitle][1],20)} inset`;


    } else {
        playPauseButton.innerHTML = '<i class="fa fa-pause"></i>'; // Set pause icon and text
        img.style.animationPlayState = 'running'; 
        playStopButton.style.boxShadow= ` 
    3px 3px 5px ${darkenRGB(playlist[currentSongTitle][1],50)} inset,
    -3px 1px 6px ${darkenRGB(playlist[currentSongTitle][1],40)} inset,
    -3px -1px 6px ${darkenRGB(playlist[currentSongTitle][1],40)} inset`;
    }
}

// Function to toggle play/pause when the button is clicked
function togglePlayPause() {
    if (audioPlayer.paused) {
        audioPlayer.play();
    } else {
        audioPlayer.pause();
    }
    updatePlayPauseButton();
}

// Function to play the next song in the playlist
const repeatCheckbox = document.getElementById('repeat-button');

function playNextSong() {
    if (repeatCheckbox.checked){
        const titles = Object.keys(playlist);
        playSong(titles[currentSongIndex]);
        
    }
    else{
        const titles = Object.keys(playlist);
        currentSongIndex = (currentSongIndex + 1) % titles.length;  // Increment index and wrap around if at the end
        playSong(titles[currentSongIndex]);  // Play the next song

    }
    
}

repeatCheckbox.addEventListener("change", function(){
    const repeatButton = document.getElementById('repeatButtonIcon');
    const songTitles = Object.keys(playlist);
    const currentSongTitle = songTitles[currentSongIndex];

    if (repeatCheckbox.checked){
        repeatIcon.innerHTML = '<i class="fa fa-remove"></i>';

        repeatButton.style.boxShadow= `-5px 5px 5px ${darkenRGB(playlist[currentSongTitle][1],50)}, 
    2px -2px 1px ${lightenRGB(playlist[currentSongTitle][1],10)},
    3px 2px 5px ${darkenRGB(playlist[currentSongTitle][1],20)} inset`;
        
        console.log("repeat button is checked");
    }
    else{
        repeatIcon.innerHTML = '<i class="fa fa-refresh"></i>';
        repeatButton.style.boxShadow= ` 
    3px 3px 5px ${darkenRGB(playlist[currentSongTitle][1],50)} inset,
    -3px 1px 6px ${darkenRGB(playlist[currentSongTitle][1],40)} inset,
    -3px -1px 6px ${darkenRGB(playlist[currentSongTitle][1],40)} inset`;
    }
});


repeatIcon.addEventListener("click", () => {
    repeatCheckbox.checked = !repeatCheckbox.checked; // Toggle checkbox state
    repeatCheckbox.dispatchEvent(new Event("change")); // Trigger 'change' event for synchronization
    });



function getIndexPlaylist(index){
    const keyatindex = keys[index];
    return keyatindex;
}


function playRandomSong(){
    console.log("rand button clicked");
    const randomSongIndex = Math.floor(Math.random() * Object.keys(playlist).length);
    console.log(randomSongIndex);
    const randomTitle = getIndexPlaylist(randomSongIndex);
    console.log(randomTitle);
    currentSongIndex = randomSongIndex;
    playSong(randomTitle);
}

randomSongButton.addEventListener('click',playRandomSong);

audioPlayer.addEventListener('ended', playNextSong);

// Event listener for the play/pause button
playPauseButton.addEventListener('click', togglePlayPause);

// Event listener for dropdown song change
songSelect.addEventListener('change', function() {
    const selectedTitle = songSelect.value;
    currentSongIndex = Object.keys(playlist).indexOf(selectedTitle);  // Update index based on selection
    playSong(selectedTitle);  // Play the selected song
});


populatePlaylist();
updatePlayPauseButton();

/*
function toggleTheme() {
    // Get the checkbox input by its ID
    const checkbox = document.getElementById('toggleThemeCheckbox');
    
    // Check if the checkbox is checked
    if (checkbox.checked) {
        // Add the 'dark-mode' class to the body
        document.body.classList.add('dark-mode');
    } else {
        // Remove the 'dark-mode' class from the body
        document.body.classList.remove('dark-mode');
    }
}
*/


const audio = document.getElementById("audioPlayer");
const seekbar = document.getElementById("seekbar");

// Update the progress bar as the audio plays
audio.addEventListener("timeupdate", function() {
    const progress = (audio.currentTime / audio.duration) * 100;
    seekbar.value = progress;
});

seekbar.addEventListener("input", function() {
    const seekTo = (seekbar.value / 100) * audio.duration; 
    audio.currentTime = seekTo; 
});

function updateSeekBarBackground() {
    const value = (seekbar.value / seekbar.max) * 100; 
    seekbar.style.setProperty("--seek-value", `${value}%`);
    setProgress(value);
}
    
audio.addEventListener("timeupdate", function () {
    const progress = (audio.currentTime / audio.duration) * 100; // Calculate percentage
    seekbar.value = progress; // Update the seekbar position
    updateSeekBarBackground();
});
    
seekbar.addEventListener("input", function () {
        const time = (seekbar.value / 100) * audio.duration; // Map slider value to audio time
        audio.currentTime = time;
        updateSeekBarBackground();
});

let progressCircle = document.querySelector(".progress");
let radius = progressCircle.r.baseVal.value;
let circumference = (radius * 2 * Math.PI)/2;
progressCircle.style.strokeDasharray = circumference;

    
function setProgress(percent) {
    progressCircle.style.strokeDashoffset = circumference+ (percent / 100) * circumference; 
}
        
changeProgress();
function changeProgress() {
    let progresstime = 100;
    setProgress(progresstime);
    
    for (let i = 100; i >= 0; i--) {
        setTimeout(() => {
            progresstime = i;
            setProgress(progresstime);
        }, i * 10); // Each increment happens every 1 second
    }
}

